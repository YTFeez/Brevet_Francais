import React, { useState, useEffect } from 'react';
import { BookOpen, Award, User, LogOut, Menu, X, ChevronRight, Star, Trophy, CheckCircle } from 'lucide-react';

const FrenchHelpSite = () => {
  const [currentPage, setCurrentPage] = useState('home');
  const [isLoggedIn, setIsLoggedIn] = useState(false);
  const [showAuthModal, setShowAuthModal] = useState(false);
  const [authMode, setAuthMode] = useState('login');
  const [username, setUsername] = useState('');
  const [password, setPassword] = useState('');
  const [currentUser, setCurrentUser] = useState(null);
  const [menuOpen, setMenuOpen] = useState(false);

  // Charger les donn√©es utilisateur au d√©marrage
  useEffect(() => {
    const savedUser = localStorage.getItem('currentUser');
    if (savedUser) {
      const user = JSON.parse(savedUser);
      setCurrentUser(user);
      setIsLoggedIn(true);
    }
  }, []);

  // Sauvegarder l'utilisateur
  const saveUser = (user) => {
    const users = JSON.parse(localStorage.getItem('users') || '[]');
    const index = users.findIndex(u => u.username === user.username);
    if (index >= 0) {
      users[index] = user;
    } else {
      users.push(user);
    }
    localStorage.setItem('users', JSON.stringify(users));
    localStorage.setItem('currentUser', JSON.stringify(user));
    setCurrentUser(user);
  };

  // Syst√®me de rangs
  const getRank = (points) => {
    if (points < 100) return { name: 'D√©butant', icon: 'üå±' };
    if (points < 300) return { name: 'Apprenti', icon: 'üìö' };
    if (points < 600) return { name: 'Coll√©gien motiv√©', icon: '‚≠ê' };
    if (points < 1000) return { name: 'Expert 3e', icon: 'üèÜ' };
    return { name: 'Pr√™t pour le brevet', icon: 'üéì' };
  };

  // Authentification
  const handleAuth = () => {
    if (authMode === 'login') {
      const users = JSON.parse(localStorage.getItem('users') || '[]');
      const user = users.find(u => u.username === username && u.password === password);
      if (user) {
        setIsLoggedIn(true);
        setCurrentUser(user);
        localStorage.setItem('currentUser', JSON.stringify(user));
        setShowAuthModal(false);
        setUsername('');
        setPassword('');
      } else {
        alert('Nom d\'utilisateur ou mot de passe incorrect');
      }
    } else {
      const users = JSON.parse(localStorage.getItem('users') || '[]');
      if (users.find(u => u.username === username)) {
        alert('Ce nom d\'utilisateur existe d√©j√†');
        return;
      }
      const newUser = { username, password, points: 0, completedExercises: [] };
      saveUser(newUser);
      setIsLoggedIn(true);
      setShowAuthModal(false);
      setUsername('');
      setPassword('');
    }
  };

  const handleLogout = () => {
    setIsLoggedIn(false);
    setCurrentUser(null);
    localStorage.removeItem('currentUser');
    setCurrentPage('home');
  };

  const addPoints = (points) => {
    if (currentUser) {
      const updatedUser = { ...currentUser, points: currentUser.points + points };
      saveUser(updatedUser);
    }
  };

  // Pages de contenu
  const GrammarPage = () => {
    const [selectedLesson, setSelectedLesson] = useState(null);
    const [exerciseAnswers, setExerciseAnswers] = useState({});

    const lessons = [
      {
        id: 1,
        title: 'Les classes de mots',
        content: 'Les mots de la langue fran√ßaise se classent en 9 cat√©gories principales.',
        rule: 'Il existe des mots variables (qui changent) et invariables (qui ne changent pas).',
        example: '‚Ä¢ Nom : chien, maison\n‚Ä¢ Verbe : manger, courir\n‚Ä¢ Adjectif : beau, grand\n‚Ä¢ Adverbe : rapidement, tr√®s',
        exercise: {
          question: 'Dans la phrase "Le chat noir mange rapidement", identifie la classe de chaque mot.',
          answer: 'Le = d√©terminant, chat = nom, noir = adjectif, mange = verbe, rapidement = adverbe',
          points: 10
        }
      },
      {
        id: 2,
        title: 'Les fonctions grammaticales',
        content: 'La fonction d\'un mot indique son r√¥le dans la phrase.',
        rule: 'Pour trouver le sujet, pose la question "Qui est-ce qui ?" ou "Qu\'est-ce qui ?" avant le verbe.',
        example: 'Dans "Marie mange une pomme" :\n‚Ä¢ Marie = sujet (qui mange ?)\n‚Ä¢ une pomme = compl√©ment d\'objet direct (mange quoi ?)',
        exercise: {
          question: 'Trouve le sujet dans : "Les √©l√®ves travaillent s√©rieusement."',
          answer: 'Les √©l√®ves',
          points: 10
        }
      },
      {
        id: 3,
        title: 'Les accords',
        content: 'Les accords permettent de relier les mots entre eux correctement.',
        rule: 'Le verbe s\'accorde avec son sujet. L\'adjectif s\'accorde avec le nom qu\'il qualifie.',
        example: '‚Ä¢ Les filles sont contentes (f√©minin pluriel)\n‚Ä¢ Le gar√ßon est content (masculin singulier)',
        exercise: {
          question: 'Accorde correctement : "Les fleurs (√™tre) beau."',
          answer: 'Les fleurs sont belles',
          points: 15
        }
      }
    ];

    const checkAnswer = (lessonId, userAnswer) => {
      const lesson = lessons.find(l => l.id === lessonId);
      const isCorrect = userAnswer.toLowerCase().trim() === lesson.exercise.answer.toLowerCase().trim();
      
      if (isCorrect && currentUser) {
        addPoints(lesson.exercise.points);
        alert(`Bravo ! Tu gagnes ${lesson.exercise.points} points ! üéâ`);
      } else if (!isCorrect) {
        alert(`Pas tout √† fait. La r√©ponse √©tait : ${lesson.exercise.answer}`);
      }
      
      setExerciseAnswers({ ...exerciseAnswers, [lessonId]: '' });
    };

    if (selectedLesson) {
      const lesson = lessons.find(l => l.id === selectedLesson);
      return (
        <div className="max-w-3xl mx-auto">
          <button onClick={() => setSelectedLesson(null)} className="mb-4 text-blue-600 hover:underline">
            ‚Üê Retour aux le√ßons
          </button>
          <div className="bg-white rounded-lg shadow-md p-6">
            <h2 className="text-2xl font-bold text-gray-800 mb-4">{lesson.title}</h2>
            
            <div className="mb-6">
              <h3 className="text-lg font-semibold text-gray-700 mb-2">üìñ Explication</h3>
              <p className="text-gray-600">{lesson.content}</p>
            </div>

            <div className="mb-6 bg-blue-50 p-4 rounded">
              <h3 className="text-lg font-semibold text-blue-800 mb-2">üìù R√®gle √† retenir</h3>
              <p className="text-gray-700">{lesson.rule}</p>
            </div>

            <div className="mb-6 bg-green-50 p-4 rounded">
              <h3 className="text-lg font-semibold text-green-800 mb-2">üí° Exemples</h3>
              <pre className="text-gray-700 whitespace-pre-wrap">{lesson.example}</pre>
            </div>

            <div className="bg-yellow-50 p-4 rounded">
              <h3 className="text-lg font-semibold text-yellow-800 mb-3">‚úèÔ∏è Exercice ({lesson.exercise.points} points)</h3>
              <p className="text-gray-700 mb-3">{lesson.exercise.question}</p>
              <input
                type="text"
                value={exerciseAnswers[lesson.id] || ''}
                onChange={(e) => setExerciseAnswers({ ...exerciseAnswers, [lesson.id]: e.target.value })}
                className="w-full p-2 border rounded mb-2"
                placeholder="Ta r√©ponse..."
              />
              <button
                onClick={() => checkAnswer(lesson.id, exerciseAnswers[lesson.id])}
                className="bg-yellow-600 text-white px-4 py-2 rounded hover:bg-yellow-700"
              >
                V√©rifier
              </button>
            </div>
          </div>
        </div>
      );
    }

    return (
      <div className="max-w-4xl mx-auto">
        <h1 className="text-3xl font-bold text-gray-800 mb-6">üìö Grammaire</h1>
        <p className="text-gray-600 mb-8">Apprends les bases de la grammaire fran√ßaise pas √† pas.</p>
        
        <div className="grid gap-4">
          {lessons.map(lesson => (
            <div key={lesson.id} className="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition cursor-pointer" onClick={() => setSelectedLesson(lesson.id)}>
              <div className="flex justify-between items-center">
                <h3 className="text-xl font-semibold text-gray-800">{lesson.title}</h3>
                <ChevronRight className="text-blue-600" />
              </div>
              <p className="text-gray-600 mt-2">{lesson.content}</p>
            </div>
          ))}
        </div>
      </div>
    );
  };

  const ConjugationPage = () => (
    <div className="max-w-4xl mx-auto">
      <h1 className="text-3xl font-bold text-gray-800 mb-6">‚è∞ Conjugaison</h1>
      <p className="text-gray-600 mb-8">Ma√Ætrise les temps verbaux essentiels pour le brevet.</p>
      
      <div className="grid gap-6">
        <div className="bg-white rounded-lg shadow-md p-6">
          <h3 className="text-xl font-semibold text-gray-800 mb-3">Le pr√©sent</h3>
          <p className="text-gray-600 mb-3">Utilise le pr√©sent pour parler de maintenant ou d'une v√©rit√© g√©n√©rale.</p>
          <div className="bg-blue-50 p-4 rounded">
            <p className="font-semibold mb-2">Exemple : verbe MANGER</p>
            <p>Je mange, tu manges, il/elle mange</p>
            <p>Nous mangeons, vous mangez, ils/elles mangent</p>
          </div>
        </div>

        <div className="bg-white rounded-lg shadow-md p-6">
          <h3 className="text-xl font-semibold text-gray-800 mb-3">L'imparfait</h3>
          <p className="text-gray-600 mb-3">Utilise l'imparfait pour parler d'une action du pass√© qui durait.</p>
          <div className="bg-green-50 p-4 rounded">
            <p className="font-semibold mb-2">Exemple : verbe √äTRE</p>
            <p>J'√©tais, tu √©tais, il/elle √©tait</p>
            <p>Nous √©tions, vous √©tiez, ils/elles √©taient</p>
          </div>
        </div>

        <div className="bg-white rounded-lg shadow-md p-6">
          <h3 className="text-xl font-semibold text-gray-800 mb-3">Le pass√© compos√©</h3>
          <p className="text-gray-600 mb-3">Utilise le pass√© compos√© pour parler d'une action termin√©e du pass√©.</p>
          <div className="bg-yellow-50 p-4 rounded">
            <p className="font-semibold mb-2">Exemple : verbe ALLER</p>
            <p>Je suis all√©(e), tu es all√©(e), il/elle est all√©(e)</p>
            <p>Nous sommes all√©(e)s, vous √™tes all√©(e)s, ils/elles sont all√©(e)s</p>
          </div>
        </div>

        <div className="bg-white rounded-lg shadow-md p-6">
          <h3 className="text-xl font-semibold text-gray-800 mb-3">Le futur simple</h3>
          <p className="text-gray-600 mb-3">Utilise le futur pour parler de ce qui va arriver.</p>
          <div className="bg-purple-50 p-4 rounded">
            <p className="font-semibold mb-2">Exemple : verbe AVOIR</p>
            <p>J'aurai, tu auras, il/elle aura</p>
            <p>Nous aurons, vous aurez, ils/elles auront</p>
          </div>
        </div>
      </div>
    </div>
  );

  const OrthographyPage = () => (
    <div className="max-w-4xl mx-auto">
      <h1 className="text-3xl font-bold text-gray-800 mb-6">‚úçÔ∏è Orthographe</h1>
      <p className="text-gray-600 mb-8">√âvite les fautes les plus courantes avec ces astuces simples.</p>
      
      <div className="grid gap-6">
        <div className="bg-white rounded-lg shadow-md p-6">
          <h3 className="text-xl font-semibold text-gray-800 mb-3">a / √†</h3>
          <div className="space-y-2 text-gray-700">
            <p><strong>a</strong> = verbe avoir (tu peux le remplacer par "avait")</p>
            <p className="bg-blue-50 p-2 rounded">Ex : Il <u>a</u> un chat ‚Üí Il avait un chat ‚úì</p>
            <p><strong>√†</strong> = pr√©position (ne change jamais)</p>
            <p className="bg-blue-50 p-2 rounded">Ex : Je vais <u>√†</u> l'√©cole ‚Üí Je vais avait l'√©cole ‚úó</p>
          </div>
        </div>

        <div className="bg-white rounded-lg shadow-md p-6">
          <h3 className="text-xl font-semibold text-gray-800 mb-3">et / est</h3>
          <div className="space-y-2 text-gray-700">
            <p><strong>et</strong> = mot de liaison (tu peux le remplacer par "et puis")</p>
            <p className="bg-green-50 p-2 rounded">Ex : Paul <u>et</u> Marie ‚Üí Paul et puis Marie ‚úì</p>
            <p><strong>est</strong> = verbe √™tre (tu peux le remplacer par "√©tait")</p>
            <p className="bg-green-50 p-2 rounded">Ex : Il <u>est</u> gentil ‚Üí Il √©tait gentil ‚úì</p>
          </div>
        </div>

        <div className="bg-white rounded-lg shadow-md p-6">
          <h3 className="text-xl font-semibold text-gray-800 mb-3">son / sont</h3>
          <div className="space-y-2 text-gray-700">
            <p><strong>son</strong> = d√©terminant possessif (tu peux le remplacer par "mon")</p>
            <p className="bg-yellow-50 p-2 rounded">Ex : <u>Son</u> livre ‚Üí Mon livre ‚úì</p>
            <p><strong>sont</strong> = verbe √™tre (tu peux le remplacer par "√©taient")</p>
            <p className="bg-yellow-50 p-2 rounded">Ex : Ils <u>sont</u> l√† ‚Üí Ils √©taient l√† ‚úì</p>
          </div>
        </div>

        <div className="bg-white rounded-lg shadow-md p-6">
          <h3 className="text-xl font-semibold text-gray-800 mb-3">L'accord du participe pass√©</h3>
          <div className="space-y-2 text-gray-700">
            <p><strong>Avec √™tre :</strong> le participe s'accorde avec le sujet</p>
            <p className="bg-purple-50 p-2 rounded">Ex : Elles sont <u>all√©es</u> (f√©minin pluriel)</p>
            <p><strong>Avec avoir :</strong> le participe ne s'accorde pas (sauf cas particulier)</p>
            <p className="bg-purple-50 p-2 rounded">Ex : Elles ont <u>mang√©</u> (pas d'accord)</p>
          </div>
        </div>
      </div>
    </div>
  );

  const BrevetPage = () => (
    <div className="max-w-4xl mx-auto">
      <h1 className="text-3xl font-bold text-gray-800 mb-6">üéØ M√©thode Brevet</h1>
      <p className="text-gray-600 mb-8">Pr√©pare-toi efficacement pour r√©ussir l'√©preuve de fran√ßais du brevet.</p>
      
      <div className="grid gap-6">
        <div className="bg-white rounded-lg shadow-md p-6">
          <h3 className="text-xl font-semibold text-gray-800 mb-3">1. R√©pondre aux questions de compr√©hension</h3>
          <ul className="space-y-2 text-gray-700">
            <li className="flex items-start">
              <CheckCircle className="text-green-600 mr-2 mt-1 flex-shrink-0" size={20} />
              <span>Lis bien la question et souligne les mots importants</span>
            </li>
            <li className="flex items-start">
              <CheckCircle className="text-green-600 mr-2 mt-1 flex-shrink-0" size={20} />
              <span>Cherche la r√©ponse dans le texte</span>
            </li>
            <li className="flex items-start">
              <CheckCircle className="text-green-600 mr-2 mt-1 flex-shrink-0" size={20} />
              <span>Cite le texte entre guillemets si n√©cessaire</span>
            </li>
            <li className="flex items-start">
              <CheckCircle className="text-green-600 mr-2 mt-1 flex-shrink-0" size={20} />
              <span>R√©dige une phrase compl√®te avec sujet + verbe</span>
            </li>
          </ul>
        </div>

        <div className="bg-white rounded-lg shadow-md p-6">
          <h3 className="text-xl font-semibold text-gray-800 mb-3">2. √âcrire un paragraphe clair</h3>
          <div className="bg-blue-50 p-4 rounded space-y-2 text-gray-700">
            <p><strong>Structure :</strong></p>
            <p>‚Ä¢ 1 id√©e principale par paragraphe</p>
            <p>‚Ä¢ 1 phrase d'introduction</p>
            <p>‚Ä¢ 2-3 phrases qui d√©veloppent</p>
            <p>‚Ä¢ 1 phrase de conclusion</p>
            <p className="mt-3"><strong>Astuce :</strong> Fais des phrases courtes et simples pour √©viter les fautes !</p>
          </div>
        </div>

        <div className="bg-white rounded-lg shadow-md p-6">
          <h3 className="text-xl font-semibold text-gray-800 mb-3">3. La r√©daction (sujet d'invention ou de r√©flexion)</h3>
          <div className="space-y-3">
            <div className="bg-green-50 p-4 rounded">
              <p className="font-semibold text-gray-800 mb-2">Avant d'√©crire :</p>
              <p className="text-gray-700">‚Ä¢ Lis bien la consigne</p>
              <p className="text-gray-700">‚Ä¢ Fais un plan au brouillon (introduction, 2-3 parties, conclusion)</p>
              <p className="text-gray-700">‚Ä¢ Note tes id√©es principales</p>
            </div>
            <div className="bg-yellow-50 p-4 rounded">
              <p className="font-semibold text-gray-800 mb-2">En √©crivant :</p>
              <p className="text-gray-700">‚Ä¢ Saute des lignes entre les parties</p>
              <p className="text-gray-700">‚Ä¢ V√©rifie tes accords (sujet-verbe, nom-adjectif)</p>
              <p className="text-gray-700">‚Ä¢ Relis-toi √† la fin !</p>
            </div>
          </div>
        </div>

        <div className="bg-white rounded-lg shadow-md p-6">
          <h3 className="text-xl font-semibold text-gray-800 mb-3">4. Gestion du temps</h3>
          <div className="bg-purple-50 p-4 rounded">
            <p className="text-gray-700 mb-2"><strong>Dur√©e totale : 3h</strong></p>
            <p className="text-gray-700">‚Ä¢ Questions de compr√©hension : 1h</p>
            <p className="text-gray-700">‚Ä¢ Dict√©e : 20 min</p>
            <p className="text-gray-700">‚Ä¢ R√©√©criture : 15 min</p>
            <p className="text-gray-700">‚Ä¢ R√©daction : 1h15</p>
            <p className="text-gray-700 mt-2"><strong>Garde 10 min pour te relire !</strong></p>
          </div>
        </div>
      </div>
    </div>
  );

  const DicteePage = () => {
    const [currentDictation, setCurrentDictation] = useState(null);
    const [userText, setUserText] = useState('');
    const [showCorrection, setShowCorrection] = useState(false);

    const dictations = [
      {
        id: 1,
        title: 'Dict√©e 1 - Niveau facile',
        text: 'Le chat noir dort sur le canap√©. Il est tr√®s fatigu√©.',
        audio: 'üîä Audio disponible',
        points: 20
      },
      {
        id: 2,
        title: 'Dict√©e 2 - Niveau moyen',
        text: 'Les enfants jouent dans le jardin. Ils sont contents et rient beaucoup.',
        audio: 'üîä Audio disponible',
        points: 30
      }
    ];

    const checkDictation = () => {
      const dictation = dictations.find(d => d.id === currentDictation);
      const correctText = dictation.text.toLowerCase().trim();
      const userTextClean = userText.toLowerCase().trim();
      
      const similarity = userTextClean === correctText ? 100 : 
        Math.round((1 - (levenshteinDistance(correctText, userTextClean) / Math.max(correctText.length, userTextClean.length))) * 100);
      
      if (similarity >= 90 && currentUser) {
        addPoints(dictation.points);
        alert(`Excellent ! Tu gagnes ${dictation.points} points ! üéâ`);
      } else if (similarity >= 70) {
        alert(`Bien ! Quelques petites erreurs. Continue comme √ßa !`);
      }
      
      setShowCorrection(true);
    };

    const levenshteinDistance = (a, b) => {
      const matrix = [];
      for (let i = 0; i <= b.length; i++) {
        matrix[i] = [i];
      }
      for (let j = 0; j <= a.length; j++) {
        matrix[0][j] = j;
      }
      for (let i = 1; i <= b.length; i++) {
        for (let j = 1; j <= a.length; j++) {
          if (b.charAt(i - 1) === a.charAt(j - 1)) {
            matrix[i][j] = matrix[i - 1][j - 1];
          } else {
            matrix[i][j] = Math.min(
              matrix[i - 1][j - 1] + 1,
              matrix[i][j - 1] + 1,
              matrix[i - 1][j] + 1
            );
          }
        }
      }
      return matrix[b.length][a.length];
    };

    if (currentDictation) {
      const dictation = dictations.find(d => d.id === currentDictation);
      return (
        <div className="max-w-3xl mx-auto">
          <button onClick={() => { setCurrentDictation(null); setUserText(''); setShowCorrection(false); }} className="mb-4 text-blue-600 hover:underline">
            ‚Üê Retour aux dict√©es
          </button>
          <div className="bg-white rounded-lg shadow-md p-6">
            <h2 className="text-2xl font-bold text-gray-800 mb-4">{dictation.title}</h2>
            <p className="text-gray-600 mb-4">{dictation.audio}</p>
            <p className="text-sm text-gray-500 mb-6">üí° Astuce : Cette version n'a pas d'audio r√©el. Lis le texte ci-dessous, cache-le, puis essaie de l'√©crire de m√©moire !</p>
            
            <div className="bg-blue-50 p-4 rounded mb-6">
              <p className="text-gray-700 font-mono">{dictation.text}</p>
            </div>

            <textarea
              value={userText}
              onChange={(e) => setUserText(e.target.value)}
              className="w-full h-32 p-3 border rounded mb-4"
              placeholder="√âcris la dict√©e ici..."
            />

            <button
              onClick={checkDictation}
              className="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 mb-4"
            >
              V√©rifier ma dict√©e
            </button>

            {showCorrection && (
              <div className="bg-green-50 p-4 rounded">
                <h3 className="font-semibold text-green-800 mb-2">‚úÖ Texte correct :</h3>
                <p className="text-gray-700 mb-3">{dictation.text}</p>
                <h3 className="font-semibold text-green-800 mb-2">üìù Ta version :</h3>
                <p className="text-gray-700">{userText}</p>
              </div>
            )}
          </div>
        </div>
      );
    }

    return (
      <div className="max-w-4xl mx-auto">
        <h1 className="text-3xl font-bold text-gray-800 mb-6">üéß Dict√©es interactives</h1>
        <p className="text-gray-600 mb-8">Entra√Æne-toi avec des dict√©es progressives pour am√©liorer ton orthographe.</p>
        
        <div className="grid gap-4">
          {dictations.map(dictation => (
            <div key={dictation.id} className="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition cursor-pointer" onClick={() => setCurrentDictation(dictation.id)}>
              <div className="flex justify-between items-center">
                <div>
                  <h3 className="text-xl font-semibold text-gray-800">{dictation.title}</h3>
                  <p className="text-gray-600 mt-2">{dictation.audio}</p>
                  <p className="text-sm text-blue-600 mt-1">R√©compense : {dictation.points} points</p>
                </div>
                <ChevronRight className="text-blue-600" />
              </div>
            </div>
          ))}
        </div>
      </div>
    );
  };

  const ProfilePage = () => {
    if (!isLoggedIn) {
      return (
        <div className="max-w-2xl mx-auto text-center">
          <h1 className="text-3xl font-bold text-gray-800 mb-4">üë§ Mon profil</h1>
          <p className="text-gray-600 mb-6">Connecte-toi pour suivre ta progression !</p>
          <button onClick={() => setShowAuthModal(true)} className="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700">
            Se connecter
          </button>
        </div>
      );
    }

    const rank = getRank(currentUser.points);

    return (
      <div className="max-w-2xl mx-auto">
        <h1 className="text-3xl font-bold text-gray-800 mb-6">üë§ Mon profil</h1>
        
        <div className="bg-white rounded-lg shadow-md p-6 mb-6">
          <div className="flex items-center justify-between mb-6">
            <div>
              <h2 className="text-2xl font-bold text-gray-800">{currentUser.username}</h2>
              <p className="text-gray-600">Membre actif</p>
            </div>
            <div className="text-5xl">{rank.icon}</div>
          </div>

          <div className="bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg p-6 mb-6">
            <div className="flex items-center justify-between">
              <div>
                <p className="text-sm opacity-90">Ton rang</p>
                <p className="text-3xl font-bold">{rank.name}</p>
              </div>
              <Trophy size={48} />
            </div>
            <div className="mt-4">
              <div className="flex justify-between text-sm mb-2">
                <span>Progression</span>
                <span>{currentUser.points} points</span>
              </div>
              <div className="bg-white bg-opacity-30 rounded-full h-3">
                <div 
                  className="bg-white rounded-full h-3 transition-all duration-300"
                  style={{ width: `${Math.min((currentUser.points % 100) || 100, 100)}%` }}
                />
              </div>
            </div>
          </div>

          <div className="grid grid-cols-3 gap-4 text-center">
            <div className="bg-blue-50 rounded-lg p-4">
              <Star className="mx-auto text-yellow-500 mb-2" size={32} />
              <p className="text-2xl font-bold text-gray-800">{currentUser.points}</p>
              <p className="text-sm text-gray-600">Points totaux</p>
            </div>
            <div className="bg-green-50 rounded-lg p-4">
              <CheckCircle className="mx-auto text-green-500 mb-2" size={32} />
              <p className="text-2xl font-bold text-gray-800">{currentUser.completedExercises?.length || 0}</p>
              <p className="text-sm text-gray-600">Exercices r√©ussis</p>
            </div>
            <div className="bg-purple-50 rounded-lg p-4">
              <Trophy className="mx-auto text-purple-500 mb-2" size={32} />
              <p className="text-2xl font-bold text-gray-800">{rank.name}</p>
              <p className="text-sm text-gray-600">Rang actuel</p>
            </div>
          </div>
        </div>

        <div className="bg-white rounded-lg shadow-md p-6">
          <h3 className="text-xl font-semibold text-gray-800 mb-4">üèÜ Tous les rangs</h3>
          <div className="space-y-3">
            {[
              { name: 'D√©butant', icon: 'üå±', points: '0-99 points' },
              { name: 'Apprenti', icon: 'üìö', points: '100-299 points' },
              { name: 'Coll√©gien motiv√©', icon: '‚≠ê', points: '300-599 points' },
              { name: 'Expert 3e', icon: 'üèÜ', points: '600-999 points' },
              { name: 'Pr√™t pour le brevet', icon: 'üéì', points: '1000+ points' }
            ].map(r => (
              <div key={r.name} className={`flex items-center justify-between p-3 rounded ${r.name === rank.name ? 'bg-blue-100 border-2 border-blue-500' : 'bg-gray-50'}`}>
                <div className="flex items-center">
                  <span className="text-2xl mr-3">{r.icon}</span>
                  <div>
                    <p className="font-semibold text-gray-800">{r.name}</p>
                    <p className="text-sm text-gray-600">{r.points}</p>
                  </div>
                </div>
                {r.name === rank.name && <span className="text-blue-600 font-semibold">Ton rang actuel</span>}
              </div>
            ))}
          </div>
        </div>
      </div>
    );
  };

  const HomePage = () => (
    <div className="max-w-4xl mx-auto">
      <div className="text-center mb-12">
        <h1 className="text-4xl font-bold text-gray-800 mb-4">Bienvenue sur ton site d'aide en fran√ßais ! üìö</h1>
        <p className="text-xl text-gray-600 mb-3">Sp√©cialement con√ßu pour les √©l√®ves de 3e</p>
        <p className="text-gray-600 max-w-2xl mx-auto">
          Tu as des difficult√©s en fran√ßais ? Pas de panique ! Ce site est l√† pour t'aider √† comprendre les bases, 
          progresser √† ton rythme et te pr√©parer sereinement au brevet. üí™
        </p>
      </div>

      <div className="bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg p-8 mb-12 shadow-lg">
        <h2 className="text-2xl font-bold mb-3">üéØ Notre objectif</h2>
        <p className="text-lg mb-4">T'aider √† reprendre confiance et √† r√©ussir en fran√ßais !</p>
        <ul className="space-y-2">
          <li className="flex items-center"><CheckCircle className="mr-2" size={20} /> Explications simples et claires</li>
          <li className="flex items-center"><CheckCircle className="mr-2" size={20} /> Exercices progressifs avec corrections</li>
          <li className="flex items-center"><CheckCircle className="mr-2" size={20} /> Syst√®me de points et de rangs motivant</li>
          <li className="flex items-center"><CheckCircle className="mr-2" size={20} /> Pr√©paration au brevet pas √† pas</li>
        </ul>
      </div>

      <h2 className="text-2xl font-bold text-gray-800 mb-6 text-center">üìñ Explore les diff√©rentes sections</h2>
      
      <div className="grid md:grid-cols-2 gap-6">
        <div onClick={() => setCurrentPage('grammar')} className="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition cursor-pointer border-2 border-transparent hover:border-blue-500">
          <div className="text-4xl mb-3">üìö</div>
          <h3 className="text-xl font-semibold text-gray-800 mb-2">Grammaire</h3>
          <p className="text-gray-600">Classes de mots, fonctions, accords... Tout est expliqu√© simplement !</p>
        </div>

        <div onClick={() => setCurrentPage('conjugation')} className="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition cursor-pointer border-2 border-transparent hover:border-green-500">
          <div className="text-4xl mb-3">‚è∞</div>
          <h3 className="text-xl font-semibold text-gray-800 mb-2">Conjugaison</h3>
          <p className="text-gray-600">Ma√Ætrise les temps essentiels : pr√©sent, imparfait, pass√© compos√©, futur.</p>
        </div>

        <div onClick={() => setCurrentPage('orthography')} className="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition cursor-pointer border-2 border-transparent hover:border-yellow-500">
          <div className="text-4xl mb-3">‚úçÔ∏è</div>
          <h3 className="text-xl font-semibold text-gray-800 mb-2">Orthographe</h3>
          <p className="text-gray-600">√âvite les fautes courantes avec des astuces faciles √† retenir !</p>
        </div>

        <div onClick={() => setCurrentPage('brevet')} className="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition cursor-pointer border-2 border-transparent hover:border-purple-500">
          <div className="text-4xl mb-3">üéØ</div>
          <h3 className="text-xl font-semibold text-gray-800 mb-2">M√©thode Brevet</h3>
          <p className="text-gray-600">Pr√©pare-toi efficacement avec nos m√©thodes et conseils pratiques.</p>
        </div>

        <div onClick={() => setCurrentPage('dictee')} className="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition cursor-pointer border-2 border-transparent hover:border-red-500">
          <div className="text-4xl mb-3">üéß</div>
          <h3 className="text-xl font-semibold text-gray-800 mb-2">Dict√©es interactives</h3>
          <p className="text-gray-600">Entra√Æne-toi avec des dict√©es progressives et gagne des points !</p>
        </div>

        <div onClick={() => setCurrentPage('profile')} className="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition cursor-pointer border-2 border-transparent hover:border-pink-500">
          <div className="text-4xl mb-3">üë§</div>
          <h3 className="text-xl font-semibold text-gray-800 mb-2">Mon profil</h3>
          <p className="text-gray-600">Suis ta progression, tes points et ton rang !</p>
        </div>
      </div>

      <div className="mt-12 bg-yellow-50 border-l-4 border-yellow-500 p-6 rounded">
        <p className="text-gray-700">
          <strong>üí° Conseil :</strong> Cr√©e ton compte pour sauvegarder ta progression et gagner des points ! 
          Plus tu travailles, plus tu grimpes dans les rangs ! üèÜ
        </p>
      </div>
    </div>
  );

  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50">
      {/* Header */}
      <header className="bg-white shadow-md sticky top-0 z-50">
        <div className="max-w-7xl mx-auto px-4 py-4">
          <div className="flex items-center justify-between">
            <div className="flex items-center cursor-pointer" onClick={() => setCurrentPage('home')}>
              <BookOpen className="text-blue-600 mr-2" size={32} />
              <div>
                <h1 className="text-2xl font-bold text-gray-800">Fran√ßais 3e</h1>
                <p className="text-sm text-gray-600">Ton aide pour r√©ussir</p>
              </div>
            </div>

            <div className="hidden md:flex items-center space-x-6">
              <button onClick={() => setCurrentPage('home')} className="text-gray-700 hover:text-blue-600 transition">Accueil</button>
              <button onClick={() => setCurrentPage('grammar')} className="text-gray-700 hover:text-blue-600 transition">Grammaire</button>
              <button onClick={() => setCurrentPage('conjugation')} className="text-gray-700 hover:text-blue-600 transition">Conjugaison</button>
              <button onClick={() => setCurrentPage('orthography')} className="text-gray-700 hover:text-blue-600 transition">Orthographe</button>
              <button onClick={() => setCurrentPage('brevet')} className="text-gray-700 hover:text-blue-600 transition">Brevet</button>
              <button onClick={() => setCurrentPage('dictee')} className="text-gray-700 hover:text-blue-600 transition">Dict√©es</button>
            </div>

            <div className="flex items-center space-x-4">
              {isLoggedIn ? (
                <>
                  <button onClick={() => setCurrentPage('profile')} className="flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
                    <User size={20} />
                    <span className="hidden md:inline">{currentUser.username}</span>
                  </button>
                  <button onClick={handleLogout} className="text-gray-700 hover:text-red-600 transition">
                    <LogOut size={24} />
                  </button>
                </>
              ) : (
                <button onClick={() => setShowAuthModal(true)} className="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition">
                  Connexion
                </button>
              )}
              <button onClick={() => setMenuOpen(!menuOpen)} className="md:hidden">
                {menuOpen ? <X size={24} /> : <Menu size={24} />}
              </button>
            </div>
          </div>

          {/* Mobile menu */}
          {menuOpen && (
            <div className="md:hidden mt-4 pb-4 space-y-2">
              <button onClick={() => { setCurrentPage('home'); setMenuOpen(false); }} className="block w-full text-left py-2 text-gray-700 hover:text-blue-600">Accueil</button>
              <button onClick={() => { setCurrentPage('grammar'); setMenuOpen(false); }} className="block w-full text-left py-2 text-gray-700 hover:text-blue-600">Grammaire</button>
              <button onClick={() => { setCurrentPage('conjugation'); setMenuOpen(false); }} className="block w-full text-left py-2 text-gray-700 hover:text-blue-600">Conjugaison</button>
              <button onClick={() => { setCurrentPage('orthography'); setMenuOpen(false); }} className="block w-full text-left py-2 text-gray-700 hover:text-blue-600">Orthographe</button>
              <button onClick={() => { setCurrentPage('brevet'); setMenuOpen(false); }} className="block w-full text-left py-2 text-gray-700 hover:text-blue-600">Brevet</button>
              <button onClick={() => { setCurrentPage('dictee'); setMenuOpen(false); }} className="block w-full text-left py-2 text-gray-700 hover:text-blue-600">Dict√©es</button>
            </div>
          )}
        </div>
      </header>

      {/* Main content */}
      <main className="max-w-7xl mx-auto px-4 py-8">
        {currentPage === 'home' && <HomePage />}
        {currentPage === 'grammar' && <GrammarPage />}
        {currentPage === 'conjugation' && <ConjugationPage />}
        {currentPage === 'orthography' && <OrthographyPage />}
        {currentPage === 'brevet' && <BrevetPage />}
        {currentPage === 'dictee' && <DicteePage />}
        {currentPage === 'profile' && <ProfilePage />}
      </main>

      {/* Auth Modal */}
      {showAuthModal && (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
          <div className="bg-white rounded-lg p-8 max-w-md w-full">
            <div className="flex justify-between items-center mb-6">
              <h2 className="text-2xl font-bold text-gray-800">
                {authMode === 'login' ? 'Connexion' : 'Inscription'}
              </h2>
              <button onClick={() => setShowAuthModal(false)} className="text-gray-500 hover:text-gray-700">
                <X size={24} />
              </button>
            </div>

            <div className="space-y-4">
              <div>
                <label className="block text-gray-700 mb-2">Nom d'utilisateur</label>
                <input
                  type="text"
                  value={username}
                  onChange={(e) => setUsername(e.target.value)}
                  className="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"
                  placeholder="Ton pseudo"
                />
              </div>

              <div>
                <label className="block text-gray-700 mb-2">Mot de passe</label>
                <input
                  type="password"
                  value={password}
                  onChange={(e) => setPassword(e.target.value)}
                  className="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"
                  placeholder="Ton mot de passe"
                />
              </div>

              <button
                onClick={handleAuth}
                className="w-full bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 transition font-semibold"
              >
                {authMode === 'login' ? 'Se connecter' : 'S\'inscrire'}
              </button>

              <button
                onClick={() => setAuthMode(authMode === 'login' ? 'register' : 'login')}
                className="w-full text-blue-600 hover:underline"
              >
                {authMode === 'login' ? 'Pas encore de compte ? Inscris-toi !' : 'D√©j√† un compte ? Connecte-toi !'}
              </button>
            </div>
          </div>
        </div>
      )}

      {/* Footer */}
      <footer className="bg-gray-800 text-white mt-12 py-8">
        <div className="max-w-7xl mx-auto px-4 text-center">
          <p className="mb-2">Site d'aide en fran√ßais - Niveau 3e</p>
          <p className="text-sm text-gray-400">Projet √©ducatif non officiel ‚Ä¢ Cr√©√© pour aider les √©l√®ves en difficult√©</p>
          <p className="text-sm text-gray-400 mt-2">üí™ Continue √† t'entra√Æner, tu vas r√©ussir !</p>
        </div>
      </footer>
    </div>
  );
};

export default FrenchHelpSite;